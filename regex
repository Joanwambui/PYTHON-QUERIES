# 1. Ensure transaction_date is datetime
fct_transactions["transaction_date"] = pd.to_datetime(
    fct_transactions["transaction_date"]
)

# 2. Filter transactions in October 2024
oct_txns = fct_transactions[
    (fct_transactions["transaction_date"] >= "2024-10-01") &
    (fct_transactions["transaction_date"] < "2024-11-01")
]

# 3. Exclude common email domains
excluded_domains = r"(gmail\.com|yahoo\.com|hotmail\.com)$"

non_common_email_txns = oct_txns[
    ~oct_txns["customer_email"].str.contains(
        excluded_domains,
        case=False,
        na=False,
        regex=True
    )
]

# 4. Count transactions
result = non_common_email_txns["transaction_id"].nunique()

print("Number of October 2024 transactions with non-common email domains:", result)
