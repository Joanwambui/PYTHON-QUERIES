import pandas as pd

# Example: ensure column is string
app_ratings["rating"] = app_ratings["rating"].astype(str)

# Map written numbers to digits
number_map = {
    "zero": 0,
    "one": 1,
    "two": 2,
    "three": 3,
    "four": 4,
    "five": 5
}

app_ratings["rating"] = (
    app_ratings["rating"]
    .str.lower()                 # standardise case
    .str.strip()                 # remove leading/trailing spaces
    .replace(number_map)         # map words to numbers
    .str.replace(",", ".", regex=False)  # handle decimal commas
)

# Convert to numeric
app_ratings["rating"] = pd.to_numeric(app_ratings["rating"], errors="coerce")


summary_stats = (
    app_ratings
        .groupby("category")["rating"]
        .agg(
            mean_rating="mean",
            median_rating="median",
            std_rating="std"
        )
        .reset_index()
)

print(summary_stats)
